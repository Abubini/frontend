<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>CLASSES & PROGRAMS</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="classes.css">
    <link rel="icon" href="logo_top.png" type="image/png" sizes="16x16">
    <style>
        .chapaform{
            display:flex;
            flex-direction:column;
            width: 50%;
            justify-content:center;
            align-items:center;
            }
            #chapa-form {
            display:flex;
            flex-direction:column;
            align-items:center;
            gap: 7px;
            width:100%;


        }
        #chapa-form input{
            width:50%;
            height: 3em;
            background-color: rgba(29, 29, 28, 0.3);
            border: none;
            color:white;

            }
            #chapa-form input:hover{
                border: 1px solid white;
                }
            input::placeholder{
	color:white;
	}
          #big{

            display:flex;
            flex-direction:column;
            align-items:center;
            justify-content:center;
            color:white;

            }
            .enroll-button{
                width:25em;
                height:2em;
                background-color: rgba(79, 79, 78, 0.3);
                color:white;
                }


        .goldchapaform{
            display:none;
            }
            #classes-container{
               width:200%;
                margin-top: 0px;
            }
    </style>
</head>
<body>


    <header>
        <div class="logo">
            <a href="index.html"><img src="logo_new.png" alt="company logo"></a>
        </div>
        <div class="navs">
            <div class="navigation">
                <a href="index.html">HOME</a>
                <a href="memberships.html">MEMBERSHIP</a>
                <a href="classtest.html">CLASSES & PROGRAMS</a>
                <a href="blogs.html">BLOG</a>
                <a href="about.html">ABOUT US</a>

            </div>
            <div class="nav-container">
       <button class="open-btn" onclick="openNav()">☰</button>
        <nav id="mySidebar" class="sidebar">
                <a href="javascript:void(0)" class="close-btn" onclick="closeNav()">×</a>
                <a href="index.html">HOME</a>
                <a href="memberships.html">MEMBERSHIP</a>
                <a href="classtest.html">CLASSES & PROGRAMS</a>
                <a href="blogs.html">BLOG</a>
                <a href="about.html">ABOUT US</a>
            </nav>
            </div>
            <div class="profile" onclick="personalPage()">
                <img src="profile-image.png" alt="" class="profile-image">
            </div>
        </div>
    </header>


    <main>
        <section class="main" id="main">

            <div id="classes-container" class="main"></div>




        </section>
         <div id="big">
             <div class="goldchapaform chapaform" id="chapaForm">
                <h1 class="plan">Your Chapa Payment Credentials</h1><br><br>
                <p class="little-description" >Please enter your Chapa payment credentials below. While it is not mandatory to provide your first name, last name, and phone number, we highly recommend including all these details to ensure a smooth and secure transaction. If you don't already have a Chapa account, you can create one by clicking the link below.</p>
                 <br>
                <form id="chapa-form">
                    <input type="text" class="long" name="first_name" id="first_name" autocomplete="complete" placeholder="First name" >
                    <input type="text" class="long" name="last_name" id="last_name" autocomplete="complete" placeholder="Last name" >
                    <input type="email" class="long" name="cemail" id="cemail" autocomplete="complete" placeholder="Email" required>
                     <input type="text" class="long" name="phone_number" id="phone_number" autocomplete="complete" placeholder="Phone number">
                    <input type="text" class="long" name="tx_ref" id="tx_ref" autocomplete="complete" placeholder="Your payment reference" required>
                    <p id="message"></p>
                    <button class="enroll-button" type="submit">Pay</button>

                </form>
                 <p>if you don't have a chapa account <a href="https://dashboard.chapa.co/register" target="_blank" style="color:white;">create one here</a></p>

                </div>
                </div>


    </main>


    <footer>
        <div class="upper">
                <div class="social">
                    <a href="https://facebook.com" target="_blank"><i class="fab fa-facebook"></i></a>
                    <a href="https://instagram.com" target="_blank"><i class="fab fa-instagram"></i></a>
                    <a href="https://twitter.com" target="_blank"><i class="fab fa-twitter"></i></a>
                    <a href="https://youtube.com" target="_blank"><i class="fab fa-youtube"></i></a>
                    <a href="https://tiktok.com" target="_blank"><i class="fab fa-tiktok"></i></a>
                    <a href="tel:+1234567890" title="Call Us"><i class="fas fa-phone"></i></a>
                    <a href="mailto:contact@example.com" title="Email Us"><i class="fas fa-envelope"></i></a>
                </div>

                <div class="rate-us">
                    <div class="rating">
                        <span onclick="gfg(1)" class="star">★</span>
                        <span onclick="gfg(2)" class="star">★</span>
                        <span onclick="gfg(3)" class="star">★</span>
                        <span onclick="gfg(4)" class="star">★</span>
                        <span onclick="gfg(5)" class="star">★</span>
                    </div>
                    <h3 id="output">Rating is: 0/5</h3>
                </div>
                </div>
            <div class="image-container">
                <a href="https://maps.app.goo.gl/tLcQf5AJhzvTwART6" target="_blank">
                    <img src="gym-map.png" alt="Placeholder Image" class="image" />
                </a>
            </div>






            <div class="footer-text">
                <p>&copy 2024 Yared Kiros, Biniam , Estifanos , Simon ,Yeabsira Addis, All Rights Reserved | AAU SITE </p>
            </div>
    </footer>
    <script>
            function openNav() {
        document.getElementById("mySidebar").style.width = "250px";
    }

    function closeNav() {
        document.getElementById("mySidebar").style.width = "0";
    }
        function personalPage() {
            window.location.href = 'personal.html';
        }
        const stars = document.getElementsByClassName("star");
        const output = document.getElementById("output");

        function gfg(n) {

            remove();

            for (let i = 0; i < n; i++) {
                let cls = ["one", "two", "three", "four", "five"][n - 1];
                stars[i].className = "star " + cls;
            }

            output.innerText = "Rating is: " + n + "/5";
        }

        function remove() {
            for (let i = 0; i < 5; i++) {
                stars[i].className = "star";
            }
        }

        async function joinclass(classname) {
    const token = sessionStorage.getItem('token');
    if (!token) {
        window.location.href = 'login.html';
        return;
    }

    try {
        const response1 = await fetch('https://vigorgym.onrender.com/users/account', {
            method: 'GET',
            headers: {
                'Authorization': `Bearer ${token}`,
            },
        });

        const accountInfo = await response1.json();
        if (!accountInfo.email) {
            throw new Error('Failed to retrieve account information.');
        }
        const email = accountInfo.email;
        document.getElementById('main').classList.add('goldchapaform');
        document.getElementById('chapaForm').classList.remove('goldchapaform');

        const registrationForm = document.getElementById('chapa-form');

        registrationForm.addEventListener('submit', async function(e) {
            e.preventDefault();

            const cemail = document.getElementById('cemail').value;
            const first_name = document.getElementById('first_name').value;
            const last_name = document.getElementById('last_name').value;
            const phone_number = document.getElementById('phone_number').value;
            const tx_ref = document.getElementById('tx_ref').value;

            try {
                const response = await fetch(`https://vigorgym.onrender.com/class/join/${email}`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        email,
                        classname,
                        cemail,
                        first_name,
                        last_name,
                        phone_number,
                        tx_ref
                    }),
                });

                const data = await response.json();

                if (data.success) {
                    document.getElementById('message').innerText = 'Registration successful!';
                } else {
                    throw new Error(data.message);
                }
            } catch (error) {
                document.getElementById('message').innerText = error.message;

            }
        });
    } catch (error) {
        document.getElementById('message').innerText = error.message;
    }
}
async function fetchClasses() {
      const response = await fetch('https://vigorgym.onrender.com/classes/getClass');
      const classes = await response.json();

      const container = document.getElementById('classes-container');
      container.innerHTML = '';

      classes.forEach(cls => {
        const classElement = document.createElement('div');
        classElement.className = 'class';

        const classPicture = document.createElement('img');
        classPicture.src = '/uploads/' + cls.picture;
        

        const details = document.createElement('div');
        details.className = 'class-detail';

        const title = document.createElement('h2');
        title.className = 'class-title';
        title.textContent = cls.name;

        const description = document.createElement('p');
        description.className = 'class-description';
        description.textContent = cls.description;

        const scheduleList = document.createElement('ul');
        scheduleList.className = 'schedule';
        cls.schedules.forEach(schedule => {
          const scheduleItem = document.createElement('li');
          scheduleItem.textContent = schedule;
          scheduleList.appendChild(scheduleItem);
        });

        const cost = document.createElement('p');
        cost.className = 'class-description';
        cost.innerHTML = `Drop-in rate: <b class="birr">${cls.cost}</b> birr/month.`;

        const button = document.createElement('button');
        button.className = 'card-button';
        button.textContent = 'Join class';
        button.onclick = function() {
        joinclass(cls.name);
    };

        details.appendChild(title);
        details.appendChild(description);
        details.appendChild(scheduleList);
        details.appendChild(cost);
        details.appendChild(button);

        classElement.appendChild(classPicture);
        classElement.appendChild(details);
        container.appendChild(classElement);
      });
    }

    document.addEventListener('DOMContentLoaded', fetchClasses);


async function yoga() {
    await joinclass('yoga');
}

async function boxing() {
    await joinclass('boxing');
}

async function aerobics() {
    await joinclass('aerobics');
}

async function karate() {
    await joinclass('karate');
}

async function aqua() {
    await joinclass('aqua');
}

async function kickboxing() {
    await joinclass('kickboxing');
}


    </script>
</body>
</html>